{% apply spaceless %}
  {% set classes = [
    'c-button',
    modifier_classes ? modifier_classes : '',
  ]|join(' ')|trim %}

  {% set button_content %}
    {%- if icon_name and icon_position != 'after' -%}
      {%- include '@components/icon/icon.twig' with {
        'is_demo': false,
        'modifier_classes': 'c-button__icon is-spaced-after',
        'is_hidden': icon_is_hidden,
        'label': icon_label,
        'icon_name': icon_name,
        'direction': icon_direction,
      } -%}
    {% endif -%}

    {{- text -}}

    {%- if icon_name and icon_position == 'after' or icon_position == 'both' -%}
      {%- include '@components/icon/icon.twig' with {
        'is_demo': false,
        'modifier_classes': 'c-button__icon is-spaced-before',
        'is_hidden': icon_is_hidden,
        'label': icon_label,
        'icon_name': icon_name,
        'direction': icon_direction,
        'gesso_image_path': gesso_image_path,
      } -%}
    {% endif -%}
  {% endset %}

  {% set demo_button_content %}
    {%- if icon_name and icon_position != 'after' -%}
      {%- include '@components/icon/icon.twig' with {
        'is_demo': false,
        'modifier_classes': 'c-button__icon is-spaced-after',
        'is_hidden': icon_is_hidden,
        'label': icon_label,
        'icon_name': icon_name,
        'direction': icon_direction,
      } -%}
    {% endif -%}

    {{- text_demo -}}

    {%- if icon_name and icon_position == 'after' or icon_position == 'both' -%}
      {%- include '@components/icon/icon.twig' with {
        'is_demo': false,
        'modifier_classes': 'c-button__icon is-spaced-before',
        'is_hidden': icon_is_hidden,
        'label': icon_label,
        'icon_name': icon_name,
        'direction': icon_direction,
      } -%}
    {% endif -%}
  {% endset %}

  {% set disabled_button_content %}
    {%- if icon_name and icon_position != 'after' -%}
      {%- include '@components/icon/icon.twig' with {
        'is_demo': false,
        'modifier_classes': 'c-button__icon is-spaced-after',
        'is_hidden': icon_is_hidden,
        'label': icon_label,
        'icon_name': icon_name,
        'direction': icon_direction,
      } -%}
    {% endif -%}

    Disabled {{ text -}}

    {%- if icon_name and icon_position == 'after' or icon_position == 'both' -%}
      {%- include '@components/icon/icon.twig' with {
        'is_demo': false,
        'modifier_classes': 'c-button__icon is-spaced-before',
        'is_hidden': icon_is_hidden,
        'label': icon_label,
        'icon_name': icon_name,
        'direction': icon_direction,
      } -%}
    {% endif -%}
  {% endset %}

  {% if is_button_tag %}
    <button {{ add_attributes({ 'class': classes }) }}{% if is_disabled %} disabled{% endif %}{% if button_type %} type="{{ button_type }}"{% endif %}>{{ button_content }}</button>
  {% else %}
    <a {{ add_attributes({ 'class': classes }) }} href="{{ url }}"{% if no_follow %} rel="nofollow"{% endif %}{% if storybook %} target="_self"{% endif %}>{{ button_content }}</a>
  {% endif %}

  {% if is_demo %}
    <a {{ add_attributes({ 'class': classes }) }} href="{{ url }}"{% if no_follow %} rel="nofollow"{% endif %}{% if storybook %} target="_self"{% endif %}>{{ demo_button_content }}</a>
    <button {{ add_attributes({ 'class': classes }) }} disabled>{{ disabled_button_content }}</button>
  {% endif %}
{% endapply -%}
